{"version":3,"sources":["../../src/components/auths.js"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAO,O;;;;;;;;;;;;;;;;;;;;;2BAEM,S;AAEX,2BAAY,UAAZ,EAAwB,UAAxB,EAAoC,QAApC,EAA6C;AAAA;;AAC3C,eAAK,UAAL,GAAkB,UAAlB;AACA,eAAK,QAAL,GAAgB,QAAhB;AACA,eAAK,UAAL,GAAkB,UAAlB;AACD;;;;gCAEK,U,EAAW;AACf,iBAAK,QAAL,GAAgB,EAAhB;AACA,iBAAK,QAAL,CAAc,IAAd,GAAqB,KAArB;AACA,iBAAK,QAAL,CAAc,IAAd,GAAqB,IAArB;AACA,iBAAK,QAAL,CAAc,MAAd,GAAuB,SAAvB;AACA,iBAAK,QAAL,CAAc,KAAd,GAAsB,mBAAtB;;;;;;AAMA,gBAAI,MAAM,KAAK,OAAL,CAAa,WAAW,QAAxB,CAAV;;AAEA,gBAAG,WAAW,QAAX,CAAoB,UAAvB,EAAkC;AAChC,kBAAI,KAAK,aAAL,IAAsB,KAAK,iBAA/B,EAAiD;AAC/C,oBAAI,WAAW,EAAC,UAAU,KAAK,aAAhB,EAA+B,UAAU,KAAK,iBAA9C,EAAf;AACA,qBAAK,WAAL,CAAiB,GAAjB,EAAsB,QAAtB;AACD,eAHD,MAGO;AACL,qBAAK,UAAL,CAAgB,QAAhB,CAAyB,eAAzB,EAA0C,CAAC,WAAW,IAAZ,EAAkB,wBAAlB,CAA1C;AACA,qBAAK,QAAL,CAAc,MAAd,GAAuB,SAAvB;AACA,qBAAK,QAAL,CAAc,KAAd,GAAsB,wBAAtB;;AAEA;AACD;AACF,aAXD,MAWO;AACL,mBAAK,UAAL,CAAgB,GAAhB;AACD;;AAGD,iBAAK,QAAL,CAAc,YAAU;AACtB,sBAAQ,GAAR,CAAY,kBAAZ;AACA,mBAAK,QAAL,CAAc,IAAd,GAAqB,IAArB;AACA,mBAAK,QAAL,CAAc,MAAd,GAAuB,SAAvB;AACA,mBAAK,QAAL,CAAc,KAAd,GAAsB,SAAtB;AAED,aANa,CAMZ,IANY,CAMP,IANO,CAAd,EAMc,IANd;AAQD;;;sCAEW,G,EAAK,Q,EAAS;AACxB,oBAAQ,GAAR,CAAY,UAAU,GAAV,GAAgB,MAAhB,GAAyB,KAAK,SAAL,CAAe,QAAf,CAArC;;AAEA,iBAAK,UAAL,CAAgB,IAAhB,CAAqB,GAArB,EAA0B,QAA1B,EAAoC,IAApC,CAAyC,UAAS,MAAT,EAAgB;AACvD,mBAAK,iBAAL,CAAuB,MAAvB;AACD,aAFwC,CAEvC,IAFuC,CAElC,IAFkC,CAAzC;AAGD;;;qCAEU,G,EAAI;AACb,oBAAQ,GAAR,CAAY,SAAS,GAArB;;AAEA,iBAAK,UAAL,CAAgB,GAAhB,CAAoB,GAApB,EAAyB,IAAzB,CAA+B,UAAS,MAAT,EAAgB;AAC7C,mBAAK,iBAAL,CAAuB,MAAvB;AACD,aAF8B,CAE7B,IAF6B,CAExB,IAFwB,CAA/B;AAGD;;;4CAEiB,M,EAAO;AACvB,oBAAQ,GAAR,CAAY,eAAZ;AACA,oBAAQ,GAAR,CAAY,MAAZ;AAED;;;kCAEO,Q,EAAS;AACf,mBAAO,aAAW,SAAS,UAApB,GAA+B,GAA/B,GAAmC,SAAS,SAA5C,GAAsD,QAA7D;AACD;;;yCAEa,CAEb","file":"auths.js","sourcesContent":["import _ from 'lodash';\n\nexport class AuthsCtrl {\n\n  constructor(backendSrv, $rootScope, $timeout){\n    this.$rootScope = $rootScope;\n    this.$timeout = $timeout;\n    this.backendSrv = backendSrv;\n  }\n\n  login(datasource){\n    this.fetching = {};\n    this.fetching.done = false;\n    this.fetching.show = true;\n    this.fetching.status = 'warning';\n    this.fetching.title = 'Fetching auths...';\n\n    //this.$rootScope.appEvent('alert-success', ['Authorization Cookie Received', '']);\n    //this.$rootScope.appEvent('alert-error', ['Authorization Failed', '']);\n    //this.$rootScope.appEvent('alert-warning', ['Fetching Authorizations', '']);\n\n    var uri = this._getURI(datasource.jsonData);\n\n    if(datasource.jsonData.basicAuths){\n      if( this.basicAuthUser && this.basicAuthPassword){\n        var authBlob = {username: this.basicAuthUser, password: this.basicAuthPassword};\n        this.doPostLogin(uri, authBlob);\n      } else {\n        this.$rootScope.appEvent('alert-warning', [datasource.name, 'requires User/Password']);\n        this.fetching.status = 'warning';\n        this.fetching.title = 'User/Password required';\n\n        return;\n      }\n    } else {\n      this.doGetLogin(uri);\n    }\n\n\n    this.$timeout(function(){\n      console.log('timeout complete')\n      this.fetching.done = true;\n      this.fetching.status = 'success';\n      this.fetching.title = \"Success\";\n\n    }.bind(this), 3000);\n\n  }\n\n  doPostLogin(uri, authBlob){\n    console.log('post ' + uri + ' <- ' + JSON.stringify(authBlob));\n\n    this.backendSrv.post(uri, authBlob).then(function(result){\n      this.handleLoginResult(result);\n    }.bind(this));\n  }\n\n  doGetLogin(uri){\n    console.log('get ' + uri);\n\n    this.backendSrv.get(uri).then( function(result){\n      this.handleLoginResult(result);\n    }.bind(this));\n  }\n\n  handleLoginResult(result){\n    console.log(\"Login Result:\")\n    console.log(result);\n\n  }\n\n  _getURI(jsonData){\n    return 'https://'+jsonData.timelyHost+':'+jsonData.httpsPort+'/login'\n  }\n\n  _showResults(){\n\n  }\n}\n"]}